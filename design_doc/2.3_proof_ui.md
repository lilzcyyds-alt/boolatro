# 2.3 Proof UI (Phase 3)

## Goal

Add a minimal UI for the **Proof phase** that wires into the Phase 1 flow and uses the pure Dart `proof_core` APIs for validation.

## Scope

- Phase overlay continues to own the UI.
- Proof state is stored in `RunState` via a dedicated `ProofState` model.
- No drag-and-drop; tapping cards appends to a conclusion string.

## UI Flow

### Proof Phase Panel

- Shows the generated **premise** from `ProofTaskGenerator`.
- Shows the current **conclusion** as the player taps cards.
- Simple **hand** of `PlayCard` tokens (atoms + connectives + parens).
- `Enter Proof Editor` button is enabled once the conclusion is non-empty.

### Proof Editor

- Displays the premise as **Line 1**.
- Proof line list (Line 2+):
  - Sentence `TextField`
  - Rule dropdown: `reit`, `&elim`, `&intro`, `~elim`, `~intro`
  - Citations input (comma-separated line numbers)
- Actions:
  - `Add Line`
  - `Clear`
  - `Submit`

### Submission

- `Submit` builds a `ProofPath` with:
  - `premise` from the generated task
  - `conclusion` from the tapped tokens
  - user-authored `ProofLine` entries
- Uses `ProofValidator.validateProofPath`.
- Shows a success/error message inline.
- Proof conclusion consistency is enforced by the validator (last line must match the conclusion).

## State Ownership

- `RunState` owns a `ProofState` instance so the phase system remains consistent.
- `ProofState` stores:
  - premise, conclusion tokens, proof lines
  - editor open flag
  - latest validation result

## Tests

Widget tests cover:
- generating a premise when entering the proof phase
- entering the proof editor after creating a conclusion
- invalid submission shows an error message
- minimal valid proof passes (premise == conclusion, `reit` cites line 1)
