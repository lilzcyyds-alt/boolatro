# 2.2 Proof Core (Pure Dart)

## Goal

Implement the Unity Boolatro **proof core** as **pure Dart** modules (no Flutter dependency), so it can be:
- unit-tested
- reused by different UIs (desktop/web/mobile)
- integrated into the Phase/RunState orchestration later

## Location

- `lib/boolatro/proof_core/`

## Public API (current)

Use `proof_core.dart` as the barrel export.

### Models

- `PlayCard`
  - `content` (token string, e.g. `P`, `~`, `&`)
  - `type` (Atom / Connective)

- `ProofLine`
  - `sentence` (string formula)
  - `rule` (e.g. `&elim`)
  - `citation` / `citations` (line references; currently implemented as parsed helpers)

- `ProofPath`
  - `premise`
  - `conclusion`
  - `proofLines`

### Generator

- `ProofTaskGenerator.generateTask(circuitLevel, difficulty)`
  - current behavior: returns `(premise, null)` (conclusion is user-provided later)
  - uses the table mapping from the Unity implementation (Simple1..Complex7)

### Validator

- `ProofValidator.isWellFormedFormula(sentence)`
- `ProofValidator.validateProofLine(...)`
- `ProofValidator.validateProofPath(...)`
- includes a strict **conclusion consistency** check:
  - the last proof line must match the target conclusion (after normalization)

Currently supported rules (subset; expand later):
- `reit`
- `&elim`
- `&intro`
- `~elim` (double negation elimination)
- `~intro` (double negation introduction)

## Tests

- `test/proof_core_test.dart`
  - WFF accept/reject cases
  - rule validation cases
  - conclusion match normalization
  - generator WFF across circuitLevel Ã— difficulty combos

## Notes / Differences vs Unity

- We intentionally avoid Unity/MonoBehaviour/UI concerns.
- Some Unity helper utilities (e.g. ProofGroupingTool) are re-implemented minimally in Dart.
- Disjunction `v` is not a priority for early gameplay; the generator currently focuses on `&` and `~` like the Unity code path.
